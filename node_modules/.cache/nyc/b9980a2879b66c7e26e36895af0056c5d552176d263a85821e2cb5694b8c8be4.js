'use strict';var cov_fglcscg67=function(){var path="/home/ngabonziza/Desktop/camp6/Quick-credit/server/controllers/loan/applyLoan.js";var hash="99a45367516c21ef5b9fde5e5b1cc203c3f4b4e9";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/ngabonziza/Desktop/camp6/Quick-credit/server/controllers/loan/applyLoan.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:7,column:19},end:{line:7,column:563}},"2":{start:{line:7,column:76},end:{line:7,column:347}},"3":{start:{line:7,column:89},end:{line:7,column:90}},"4":{start:{line:7,column:134},end:{line:7,column:142}},"5":{start:{line:7,column:144},end:{line:7,column:199}},"6":{start:{line:7,column:200},end:{line:7,column:231}},"7":{start:{line:7,column:232},end:{line:7,column:286}},"8":{start:{line:7,column:259},end:{line:7,column:286}},"9":{start:{line:7,column:287},end:{line:7,column:345}},"10":{start:{line:7,column:350},end:{line:7,column:559}},"11":{start:{line:7,column:407},end:{line:7,column:475}},"12":{start:{line:7,column:423},end:{line:7,column:475}},"13":{start:{line:7,column:476},end:{line:7,column:536}},"14":{start:{line:7,column:493},end:{line:7,column:536}},"15":{start:{line:7,column:537},end:{line:7,column:556}},"16":{start:{line:9,column:14},end:{line:9,column:44}},"17":{start:{line:11,column:15},end:{line:11,column:46}},"18":{start:{line:13,column:18},end:{line:13,column:53}},"19":{start:{line:15,column:19},end:{line:15,column:54}},"20":{start:{line:17,column:14},end:{line:17,column:31}},"21":{start:{line:19,column:15},end:{line:19,column:46}},"22":{start:{line:21,column:39},end:{line:21,column:93}},"23":{start:{line:23,column:33},end:{line:23,column:456}},"24":{start:{line:23,column:64},end:{line:23,column:89}},"25":{start:{line:23,column:91},end:{line:23,column:453}},"26":{start:{line:23,column:165},end:{line:23,column:263}},"27":{start:{line:23,column:182},end:{line:23,column:195}},"28":{start:{line:23,column:209},end:{line:23,column:219}},"29":{start:{line:23,column:239},end:{line:23,column:253}},"30":{start:{line:23,column:254},end:{line:23,column:261}},"31":{start:{line:23,column:264},end:{line:23,column:426}},"32":{start:{line:23,column:281},end:{line:23,column:296}},"33":{start:{line:23,column:306},end:{line:23,column:424}},"34":{start:{line:23,column:360},end:{line:23,column:380}},"35":{start:{line:23,column:401},end:{line:23,column:420}},"36":{start:{line:23,column:429},end:{line:23,column:449}},"37":{start:{line:25,column:50},end:{line:25,column:151}},"38":{start:{line:25,column:92},end:{line:25,column:149}},"39":{start:{line:27,column:16},end:{line:106,column:3}},"40":{start:{line:29,column:8},end:{line:29,column:41}},"41":{start:{line:32,column:4},end:{line:103,column:8}},"42":{start:{line:35,column:23},end:{line:95,column:15}},"43":{start:{line:38,column:16},end:{line:94,column:34}},"44":{start:{line:39,column:20},end:{line:93,column:21}},"45":{start:{line:40,column:24},end:{line:92,column:25}},"46":{start:{line:42,column:32},end:{line:42,column:140}},"47":{start:{line:44,column:32},end:{line:47,column:33}},"48":{start:{line:45,column:36},end:{line:45,column:54}},"49":{start:{line:46,column:36},end:{line:46,column:42}},"50":{start:{line:49,column:32},end:{line:49,column:113}},"51":{start:{line:52,column:32},end:{line:52,column:130}},"52":{start:{line:53,column:32},end:{line:53,column:65}},"53":{start:{line:54,column:32},end:{line:54,column:82}},"54":{start:{line:55,column:32},end:{line:55,column:145}},"55":{start:{line:56,column:32},end:{line:56,column:74}},"56":{start:{line:57,column:32},end:{line:67,column:34}},"57":{start:{line:69,column:32},end:{line:74,column:33}},"58":{start:{line:70,column:36},end:{line:70,column:64}},"59":{start:{line:72,column:36},end:{line:72,column:55}},"60":{start:{line:73,column:36},end:{line:73,column:42}},"61":{start:{line:76,column:32},end:{line:79,column:36}},"62":{start:{line:82,column:32},end:{line:82,column:60}},"63":{start:{line:83,column:32},end:{line:87,column:36}},"64":{start:{line:91,column:32},end:{line:91,column:55}},"65":{start:{line:98,column:16},end:{line:98,column:51}},"66":{start:{line:101,column:12},end:{line:101,column:29}},"67":{start:{line:105,column:4},end:{line:105,column:21}},"68":{start:{line:108,column:16},end:{line:108,column:31}},"69":{start:{line:109,column:0},end:{line:109,column:28}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:7,column:19},end:{line:7,column:20}},loc:{start:{line:7,column:31},end:{line:7,column:561}},line:7},"1":{name:"defineProperties",decl:{start:{line:7,column:42},end:{line:7,column:58}},loc:{start:{line:7,column:74},end:{line:7,column:349}},line:7},"2":{name:"(anonymous_2)",decl:{start:{line:7,column:357},end:{line:7,column:358}},loc:{start:{line:7,column:405},end:{line:7,column:558}},line:7},"3":{name:"_interopRequireDefault",decl:{start:{line:21,column:9},end:{line:21,column:31}},loc:{start:{line:21,column:37},end:{line:21,column:95}},line:21},"4":{name:"_asyncToGenerator",decl:{start:{line:23,column:9},end:{line:23,column:26}},loc:{start:{line:23,column:31},end:{line:23,column:458}},line:23},"5":{name:"(anonymous_5)",decl:{start:{line:23,column:40},end:{line:23,column:41}},loc:{start:{line:23,column:52},end:{line:23,column:455}},line:23},"6":{name:"(anonymous_6)",decl:{start:{line:23,column:110},end:{line:23,column:111}},loc:{start:{line:23,column:137},end:{line:23,column:451}},line:23},"7":{name:"step",decl:{start:{line:23,column:148},end:{line:23,column:152}},loc:{start:{line:23,column:163},end:{line:23,column:428}},line:23},"8":{name:"(anonymous_8)",decl:{start:{line:23,column:341},end:{line:23,column:342}},loc:{start:{line:23,column:358},end:{line:23,column:382}},line:23},"9":{name:"(anonymous_9)",decl:{start:{line:23,column:384},end:{line:23,column:385}},loc:{start:{line:23,column:399},end:{line:23,column:422}},line:23},"10":{name:"_classCallCheck",decl:{start:{line:25,column:9},end:{line:25,column:24}},loc:{start:{line:25,column:48},end:{line:25,column:153}},line:25},"11":{name:"(anonymous_11)",decl:{start:{line:27,column:16},end:{line:27,column:17}},loc:{start:{line:27,column:28},end:{line:106,column:1}},line:27},"12":{name:"ApplyLoan",decl:{start:{line:28,column:13},end:{line:28,column:22}},loc:{start:{line:28,column:25},end:{line:30,column:5}},line:28},"13":{name:"(anonymous_13)",decl:{start:{line:34,column:15},end:{line:34,column:16}},loc:{start:{line:34,column:27},end:{line:102,column:9}},line:34},"14":{name:"_callee",decl:{start:{line:35,column:88},end:{line:35,column:95}},loc:{start:{line:35,column:106},end:{line:95,column:13}},line:35},"15":{name:"_callee$",decl:{start:{line:38,column:56},end:{line:38,column:64}},loc:{start:{line:38,column:75},end:{line:94,column:17}},line:38},"16":{name:"(anonymous_16)",decl:{start:{line:69,column:61},end:{line:69,column:62}},loc:{start:{line:69,column:77},end:{line:71,column:33}},line:69},"17":{name:"loanApply",decl:{start:{line:97,column:21},end:{line:97,column:30}},loc:{start:{line:97,column:40},end:{line:99,column:13}},line:97}},branchMap:{"0":{loc:{start:{line:7,column:168},end:{line:7,column:198}},type:"binary-expr",locations:[{start:{line:7,column:168},end:{line:7,column:189}},{start:{line:7,column:193},end:{line:7,column:198}}],line:7},"1":{loc:{start:{line:7,column:232},end:{line:7,column:286}},type:"if",locations:[{start:{line:7,column:232},end:{line:7,column:286}},{start:{line:7,column:232},end:{line:7,column:286}}],line:7},"2":{loc:{start:{line:7,column:407},end:{line:7,column:475}},type:"if",locations:[{start:{line:7,column:407},end:{line:7,column:475}},{start:{line:7,column:407},end:{line:7,column:475}}],line:7},"3":{loc:{start:{line:7,column:476},end:{line:7,column:536}},type:"if",locations:[{start:{line:7,column:476},end:{line:7,column:536}},{start:{line:7,column:476},end:{line:7,column:536}}],line:7},"4":{loc:{start:{line:21,column:46},end:{line:21,column:92}},type:"cond-expr",locations:[{start:{line:21,column:70},end:{line:21,column:73}},{start:{line:21,column:76},end:{line:21,column:92}}],line:21},"5":{loc:{start:{line:21,column:46},end:{line:21,column:67}},type:"binary-expr",locations:[{start:{line:21,column:46},end:{line:21,column:49}},{start:{line:21,column:53},end:{line:21,column:67}}],line:21},"6":{loc:{start:{line:23,column:264},end:{line:23,column:426}},type:"if",locations:[{start:{line:23,column:264},end:{line:23,column:426}},{start:{line:23,column:264},end:{line:23,column:426}}],line:23},"7":{loc:{start:{line:25,column:50},end:{line:25,column:151}},type:"if",locations:[{start:{line:25,column:50},end:{line:25,column:151}},{start:{line:25,column:50},end:{line:25,column:151}}],line:25},"8":{loc:{start:{line:40,column:24},end:{line:92,column:25}},type:"switch",locations:[{start:{line:41,column:28},end:{line:49,column:113}},{start:{line:51,column:28},end:{line:79,column:36}},{start:{line:81,column:28},end:{line:87,column:36}},{start:{line:89,column:28},end:{line:89,column:36}},{start:{line:90,column:28},end:{line:91,column:55}}],line:40},"9":{loc:{start:{line:44,column:32},end:{line:47,column:33}},type:"if",locations:[{start:{line:44,column:32},end:{line:47,column:33}},{start:{line:44,column:32},end:{line:47,column:33}}],line:44},"10":{loc:{start:{line:69,column:32},end:{line:74,column:33}},type:"if",locations:[{start:{line:69,column:32},end:{line:74,column:33}},{start:{line:69,column:32},end:{line:74,column:33}}],line:69}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0,0,0,0],"9":[0,0],"10":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"99a45367516c21ef5b9fde5e5b1cc203c3f4b4e9"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();cov_fglcscg67.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});var _createClass=(cov_fglcscg67.s[1]++,function(){cov_fglcscg67.f[0]++;function defineProperties(target,props){cov_fglcscg67.f[1]++;cov_fglcscg67.s[2]++;for(var i=(cov_fglcscg67.s[3]++,0);i<props.length;i++){var descriptor=(cov_fglcscg67.s[4]++,props[i]);cov_fglcscg67.s[5]++;descriptor.enumerable=(cov_fglcscg67.b[0][0]++,descriptor.enumerable)||(cov_fglcscg67.b[0][1]++,false);cov_fglcscg67.s[6]++;descriptor.configurable=true;cov_fglcscg67.s[7]++;if("value"in descriptor){cov_fglcscg67.b[1][0]++;cov_fglcscg67.s[8]++;descriptor.writable=true;}else{cov_fglcscg67.b[1][1]++;}cov_fglcscg67.s[9]++;Object.defineProperty(target,descriptor.key,descriptor);}}cov_fglcscg67.s[10]++;return function(Constructor,protoProps,staticProps){cov_fglcscg67.f[2]++;cov_fglcscg67.s[11]++;if(protoProps){cov_fglcscg67.b[2][0]++;cov_fglcscg67.s[12]++;defineProperties(Constructor.prototype,protoProps);}else{cov_fglcscg67.b[2][1]++;}cov_fglcscg67.s[13]++;if(staticProps){cov_fglcscg67.b[3][0]++;cov_fglcscg67.s[14]++;defineProperties(Constructor,staticProps);}else{cov_fglcscg67.b[3][1]++;}cov_fglcscg67.s[15]++;return Constructor;};}());var _loanDb=(cov_fglcscg67.s[16]++,require('../../models/loanDb'));var _loanDb2=(cov_fglcscg67.s[17]++,_interopRequireDefault(_loanDb));var _validation=(cov_fglcscg67.s[18]++,require('../../helpers/validation'));var _validation2=(cov_fglcscg67.s[19]++,_interopRequireDefault(_validation));var _moment=(cov_fglcscg67.s[20]++,require('moment'));var _moment2=(cov_fglcscg67.s[21]++,_interopRequireDefault(_moment));function _interopRequireDefault(obj){cov_fglcscg67.f[3]++;cov_fglcscg67.s[22]++;return(cov_fglcscg67.b[5][0]++,obj)&&(cov_fglcscg67.b[5][1]++,obj.__esModule)?(cov_fglcscg67.b[4][0]++,obj):(cov_fglcscg67.b[4][1]++,{default:obj});}function _asyncToGenerator(fn){cov_fglcscg67.f[4]++;cov_fglcscg67.s[23]++;return function(){cov_fglcscg67.f[5]++;var gen=(cov_fglcscg67.s[24]++,fn.apply(this,arguments));cov_fglcscg67.s[25]++;return new Promise(function(resolve,reject){cov_fglcscg67.f[6]++;function step(key,arg){cov_fglcscg67.f[7]++;cov_fglcscg67.s[26]++;try{var info=(cov_fglcscg67.s[27]++,gen[key](arg));var value=(cov_fglcscg67.s[28]++,info.value);}catch(error){cov_fglcscg67.s[29]++;reject(error);cov_fglcscg67.s[30]++;return;}cov_fglcscg67.s[31]++;if(info.done){cov_fglcscg67.b[6][0]++;cov_fglcscg67.s[32]++;resolve(value);}else{cov_fglcscg67.b[6][1]++;cov_fglcscg67.s[33]++;return Promise.resolve(value).then(function(value){cov_fglcscg67.f[8]++;cov_fglcscg67.s[34]++;step("next",value);},function(err){cov_fglcscg67.f[9]++;cov_fglcscg67.s[35]++;step("throw",err);});}}cov_fglcscg67.s[36]++;return step("next");});};}function _classCallCheck(instance,Constructor){cov_fglcscg67.f[10]++;cov_fglcscg67.s[37]++;if(!(instance instanceof Constructor)){cov_fglcscg67.b[7][0]++;cov_fglcscg67.s[38]++;throw new TypeError("Cannot call a class as a function");}else{cov_fglcscg67.b[7][1]++;}}var ApplyLoan=(cov_fglcscg67.s[39]++,function(){cov_fglcscg67.f[11]++;function ApplyLoan(){cov_fglcscg67.f[12]++;cov_fglcscg67.s[40]++;_classCallCheck(this,ApplyLoan);}cov_fglcscg67.s[41]++;_createClass(ApplyLoan,[{key:'loanApply',value:function(){cov_fglcscg67.f[13]++;var _ref=(cov_fglcscg67.s[42]++,_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function _callee(req,res){cov_fglcscg67.f[14]++;var _appValidation$applyV,error,_req$body,email,tenor,amount,id,interest,paymentInstallment,balance,loan;cov_fglcscg67.s[43]++;return regeneratorRuntime.wrap(function _callee$(_context){cov_fglcscg67.f[15]++;cov_fglcscg67.s[44]++;while(1){cov_fglcscg67.s[45]++;switch(_context.prev=_context.next){case 0:cov_fglcscg67.b[8][0]++;cov_fglcscg67.s[46]++;_appValidation$applyV=_validation2.default.applyValidation(req.body),error=_appValidation$applyV.error;cov_fglcscg67.s[47]++;if(!error){cov_fglcscg67.b[9][0]++;cov_fglcscg67.s[48]++;_context.next=3;cov_fglcscg67.s[49]++;break;}else{cov_fglcscg67.b[9][1]++;}cov_fglcscg67.s[50]++;return _context.abrupt('return',res.status(400).json(error.details[0].message));case 3:cov_fglcscg67.b[8][1]++;cov_fglcscg67.s[51]++;_req$body=req.body,email=_req$body.email,tenor=_req$body.tenor,amount=_req$body.amount;cov_fglcscg67.s[52]++;id=_loanDb2.default.length+1;cov_fglcscg67.s[53]++;interest=0.05*parseInt(amount,10).toFixed(2);cov_fglcscg67.s[54]++;paymentInstallment=(parseInt(amount,10)+parseInt(interest,10)).toFixed(2)/parseInt(tenor,10).toFixed(2);cov_fglcscg67.s[55]++;balance=parseInt(amount,10).toFixed(2);cov_fglcscg67.s[56]++;loan={id:id,email:email,amount:amount,tenor:tenor,paymentInstallment:paymentInstallment,balance:balance,status:'pending',repaid:false,createdOn:(0,_moment2.default)(new Date()).format('YYYY-MM-DD HH:MM:SS')};cov_fglcscg67.s[57]++;if(!_loanDb2.default.filter(function(user){cov_fglcscg67.f[16]++;cov_fglcscg67.s[58]++;return user.email===email;})){cov_fglcscg67.b[10][0]++;cov_fglcscg67.s[59]++;_context.next=11;cov_fglcscg67.s[60]++;break;}else{cov_fglcscg67.b[10][1]++;}cov_fglcscg67.s[61]++;return _context.abrupt('return',res.status(409).send({status:409,error:'You have already applied for loan!'}));case 11:cov_fglcscg67.b[8][2]++;cov_fglcscg67.s[62]++;_loanDb2.default.push(loan);cov_fglcscg67.s[63]++;return _context.abrupt('return',res.status(201).json({status:201,message:"loan created successfully",data:loan}));case 13:cov_fglcscg67.b[8][3]++;case'end':cov_fglcscg67.b[8][4]++;cov_fglcscg67.s[64]++;return _context.stop();}}},_callee,this);})));function loanApply(_x,_x2){cov_fglcscg67.f[17]++;cov_fglcscg67.s[65]++;return _ref.apply(this,arguments);}cov_fglcscg67.s[66]++;return loanApply;}()}]);cov_fglcscg67.s[67]++;return ApplyLoan;}());var applyLoan=(cov_fglcscg67.s[68]++,new ApplyLoan());cov_fglcscg67.s[69]++;exports.default=applyLoan;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcGx5TG9hbi5qcyJdLCJuYW1lcyI6WyJBcHBseUxvYW4iLCJyZXEiLCJyZXMiLCJhcHBWYWxpZGF0aW9uIiwiYXBwbHlWYWxpZGF0aW9uIiwiYm9keSIsImVycm9yIiwic3RhdHVzIiwianNvbiIsImRldGFpbHMiLCJtZXNzYWdlIiwiZW1haWwiLCJ0ZW5vciIsImFtb3VudCIsImlkIiwibG9hbkRiIiwibGVuZ3RoIiwiaW50ZXJlc3QiLCJwYXJzZUludCIsInRvRml4ZWQiLCJwYXltZW50SW5zdGFsbG1lbnQiLCJiYWxhbmNlIiwibG9hbiIsInJlcGFpZCIsImNyZWF0ZWRPbiIsIkRhdGUiLCJmb3JtYXQiLCJmaWx0ZXIiLCJ1c2VyIiwic2VuZCIsInB1c2giLCJkYXRhIiwiYXBwbHlMb2FuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7Ozs7OztJQUVNQSxTOzs7Ozs7OztnR0FDY0MsRyxFQUFLQyxHOzs7Ozs7O3dEQUNEQyxxQkFBY0MsZUFBZCxDQUE4QkgsSUFBSUksSUFBbEMsQyxFQUFUQyxLLHlCQUFBQSxLOztxQ0FDSEEsSzs7Ozs7aUVBQWNKLElBQUlLLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQkYsTUFBTUcsT0FBTixDQUFjLENBQWQsRUFBaUJDLE9BQXRDLEM7Ozs0Q0FDV1QsSUFBSUksSSxFQUExQk0sSyxhQUFBQSxLLEVBQU1DLEssYUFBQUEsSyxFQUFNQyxNLGFBQUFBLE07QUFDYkMsa0MsR0FBS0MsaUJBQU9DLE1BQVAsR0FBZ0IsQztBQUNyQkMsd0MsR0FBVyxPQUFPQyxTQUFTTCxNQUFULEVBQWlCLEVBQWpCLEVBQXFCTSxPQUFyQixDQUE2QixDQUE3QixDO0FBQ2xCQyxrRCxHQUFxQixDQUFDRixTQUFTTCxNQUFULEVBQWdCLEVBQWhCLElBQXNCSyxTQUFTRCxRQUFULEVBQWtCLEVBQWxCLENBQXZCLEVBQThDRSxPQUE5QyxDQUFzRCxDQUF0RCxJQUF5REQsU0FBU04sS0FBVCxFQUFlLEVBQWYsRUFBbUJPLE9BQW5CLENBQTJCLENBQTNCLEM7QUFDOUVFLHVDLEdBQVVILFNBQVNMLE1BQVQsRUFBaUIsRUFBakIsRUFBcUJNLE9BQXJCLENBQTZCLENBQTdCLEM7QUFDVkcsb0MsR0FBTztBQUNUUiwwQ0FEUztBQUVUSCxnREFGUztBQUdURSxrREFIUztBQUlURCxnREFKUztBQUtUUSwwRUFMUztBQU1UQyxvREFOUztBQU9UZCw0Q0FBUSxTQVBDO0FBUVRnQiw0Q0FBUSxLQVJDO0FBU1RDLCtDQUFVLHNCQUFPLElBQUlDLElBQUosRUFBUCxFQUFtQkMsTUFBbkIsQ0FBMEIscUJBQTFCO0FBVEQsaUM7O3FDQVdWWCxpQkFBT1ksTUFBUCxDQUFjO0FBQUEsMkNBQVFDLEtBQUtqQixLQUFMLEtBQWVBLEtBQXZCO0FBQUEsaUNBQWQsQzs7Ozs7aUVBQ1FULElBQUlLLE1BQUosQ0FBVyxHQUFYLEVBQWdCc0IsSUFBaEIsQ0FBcUI7QUFDeEJ0Qiw0Q0FBUSxHQURnQjtBQUV4QkQsMkNBQU87QUFGaUIsaUNBQXJCLEM7OztBQUtYUyxpREFBT2UsSUFBUCxDQUFZUixJQUFaO2lFQUNPcEIsSUFBSUssTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCO0FBQ3hCRCw0Q0FBUSxHQURnQjtBQUV4QkcsNkNBQVMsMkJBRmU7QUFHeEJxQiwwQ0FBTVQ7QUFIa0IsaUNBQXJCLEM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQU9mLElBQU1VLFlBQVksSUFBSWhDLFNBQUosRUFBbEI7a0JBQ2VnQyxTIiwiZmlsZSI6ImFwcGx5TG9hbi5qcyIsInNvdXJjZVJvb3QiOiIvaG9tZS9uZ2Fib256aXphL0Rlc2t0b3AvY2FtcDYvUXVpY2stY3JlZGl0L3NlcnZlci9jb250cm9sbGVycy9sb2FuIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGxvYW5EYiBmcm9tICcuLi8uLi9tb2RlbHMvbG9hbkRiJztcbmltcG9ydCBhcHBWYWxpZGF0aW9uIGZyb20gJy4uLy4uL2hlbHBlcnMvdmFsaWRhdGlvbic7XG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5cbmNsYXNzIEFwcGx5TG9hbntcbiAgICBhc3luYyBsb2FuQXBwbHkocmVxLCByZXMpIHsgXG4gICAgICAgIGNvbnN0IHtlcnJvcn0gPSBhcHBWYWxpZGF0aW9uLmFwcGx5VmFsaWRhdGlvbihyZXEuYm9keSk7XG4gICAgICAgIGlmIChlcnJvcikgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKGVycm9yLmRldGFpbHNbMF0ubWVzc2FnZSk7XG4gICAgICAgIGNvbnN0IHtlbWFpbCx0ZW5vcixhbW91bnR9ID0gcmVxLmJvZHk7XG4gICAgICAgIGNvbnN0IGlkID0gbG9hbkRiLmxlbmd0aCArIDE7XG4gICAgICAgIGNvbnN0IGludGVyZXN0ID0gMC4wNSAqIHBhcnNlSW50KGFtb3VudCwgMTApLnRvRml4ZWQoMik7XG4gICAgICAgIGNvbnN0IHBheW1lbnRJbnN0YWxsbWVudCA9IChwYXJzZUludChhbW91bnQsMTApICsgcGFyc2VJbnQoaW50ZXJlc3QsMTApKS50b0ZpeGVkKDIpL3BhcnNlSW50KHRlbm9yLDEwKS50b0ZpeGVkKDIpOyBcbiAgICAgICAgY29uc3QgYmFsYW5jZSA9IHBhcnNlSW50KGFtb3VudCwgMTApLnRvRml4ZWQoMik7XG4gICAgICAgIGNvbnN0IGxvYW4gPSB7XG4gICAgICAgICAgICBpZCxcbiAgICAgICAgICAgIGVtYWlsLCAgXG4gICAgICAgICAgICBhbW91bnQsXG4gICAgICAgICAgICB0ZW5vcixcbiAgICAgICAgICAgIHBheW1lbnRJbnN0YWxsbWVudCxcbiAgICAgICAgICAgIGJhbGFuY2UsXG4gICAgICAgICAgICBzdGF0dXM6ICdwZW5kaW5nJyxcbiAgICAgICAgICAgIHJlcGFpZDogZmFsc2UsXG4gICAgICAgICAgICBjcmVhdGVkT246bW9tZW50KG5ldyBEYXRlKCkpLmZvcm1hdCgnWVlZWS1NTS1ERCBISDpNTTpTUycpLFxuICAgICAgICB9O1xuICAgICAgICBpZihsb2FuRGIuZmlsdGVyKHVzZXIgPT4gdXNlci5lbWFpbCA9PT0gZW1haWwpKXtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwOSkuc2VuZCh7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiA0MDksXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdZb3UgaGF2ZSBhbHJlYWR5IGFwcGxpZWQgZm9yIGxvYW4hJyxcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgbG9hbkRiLnB1c2gobG9hbik7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMSkuanNvbih7XG4gICAgICAgICAgICBzdGF0dXM6IDIwMSxcbiAgICAgICAgICAgIG1lc3NhZ2U6IFwibG9hbiBjcmVhdGVkIHN1Y2Nlc3NmdWxseVwiLFxuICAgICAgICAgICAgZGF0YTogbG9hbixcbiAgICAgICAgfSk7XG4gICAgfVxufVxuY29uc3QgYXBwbHlMb2FuID0gbmV3IEFwcGx5TG9hbigpO1xuZXhwb3J0IGRlZmF1bHQgYXBwbHlMb2FuOyJdfQ==